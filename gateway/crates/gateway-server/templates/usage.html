{% extends "layout.html" %}

{% block content %}
<!-- Stats Summary -->
<div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
    <div class="bg-dark-800 rounded-lg border border-dark-600 p-6">
        <p class="text-sm text-gray-400 mb-1">Total Requests (24h)</p>
        <p class="text-3xl font-bold text-primary">{{ stats.total_requests }}</p>
    </div>
    <div class="bg-dark-800 rounded-lg border border-dark-600 p-6">
        <p class="text-sm text-gray-400 mb-1">Input Tokens</p>
        <p class="text-3xl font-bold text-secondary">{{ stats.total_input_tokens }}</p>
    </div>
    <div class="bg-dark-800 rounded-lg border border-dark-600 p-6">
        <p class="text-sm text-gray-400 mb-1">Output Tokens</p>
        <p class="text-3xl font-bold text-secondary">{{ stats.total_output_tokens }}</p>
    </div>
    <div class="bg-dark-800 rounded-lg border border-dark-600 p-6">
        <p class="text-sm text-gray-400 mb-1">Total Cost</p>
        <p class="text-3xl font-bold text-yellow-400">${{ stats.total_cost_usd }}</p>
    </div>
</div>

<!-- Usage Logs Table -->
<div class="bg-dark-800 rounded-lg border border-dark-600 overflow-hidden">
    <div class="px-6 py-4 border-b border-dark-600">
        <h3 class="text-lg font-semibold">Usage Logs</h3>
    </div>
    <div class="overflow-x-auto">
        <table class="w-full">
            <thead class="bg-dark-700">
                <tr>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">Time</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">API Key</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">Provider</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">Model</th>
                    <th class="px-6 py-3 text-right text-xs font-medium text-gray-400 uppercase tracking-wider">Input</th>
                    <th class="px-6 py-3 text-right text-xs font-medium text-gray-400 uppercase tracking-wider">Output</th>
                    <th class="px-6 py-3 text-right text-xs font-medium text-gray-400 uppercase tracking-wider">Cost</th>
                    <th class="px-6 py-3 text-right text-xs font-medium text-gray-400 uppercase tracking-wider">Duration</th>
                </tr>
            </thead>
            <tbody class="divide-y divide-dark-600">
                {% for log in logs %}
                <tr class="hover:bg-dark-700">
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-300">
                        {{ log.created_at.format("%Y-%m-%d %H:%M:%S") }}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm">
                        {% match log.api_key_id %}
                        {% when Some with (key_id) %}
                        <code class="text-gray-400">{{ key_id }}</code>
                        {% when None %}
                        <span class="text-gray-500">-</span>
                        {% endmatch %}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-300">{{ log.provider }}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-primary">{{ log.model }}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-300 text-right font-mono">{{ log.input_tokens }}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-300 text-right font-mono">{{ log.output_tokens }}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-yellow-400 text-right font-mono">${{ log.cost_usd }}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-400 text-right">{{ log.duration_ms }}ms</td>
                </tr>
                {% endfor %}
                {% if logs.is_empty() %}
                <tr>
                    <td colspan="8" class="px-6 py-8 text-center text-gray-500">
                        No usage logs yet. Make some API requests to see data here.
                    </td>
                </tr>
                {% endif %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
